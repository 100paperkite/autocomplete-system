<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/daisyui@2.51.3/dist/full.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2/dist/tailwind.min.css" rel="stylesheet" type="text/css" />
    <title>Auto Complete</title>
</head>
<body class="flex h-screen">
    <div class="w-96 mx-auto my-40">
        <input class="input input-bordered w-full"
               oninput="getKeywords(this.value)"
               placeholder="Search..."
               type="text" />
        <div id="dropdown"></div>
    </div>

    <script>
        class DropDown {
            constructor($element) {
                this.$element = $element;
                this.items = []
            }
            
            setItems(items) {
                this.items = items;
            }

            template() {
                return `<ul class="p-4 gap-y-2 menu shadow rounded-b-lg drop-shadow-lg">
                    ${this.items.map(item => `<li>${item}</li>`).join('')}
                    </ul>`;
            }

            render() {
                this.$element.innerHTML = this.template()
            }
        }

        const dropdown = new DropDown(document.querySelector("#dropdown"));
        
        const getKeywords = async (prefix) => {
            const keywords = 
                    await fetch(`http://localhost:8080/complete/search?q=${prefix}`,
                        { headers: {"Content-Type": "application/json"}})
                    .then((response) => response.json())
                    .then((data) => data)
                    .catch((error) => {
                        console.log("Error", error);
                    });
                
            if (keywords){
                dropdown.setItems(keywords);
                dropdown.render();
            }
        }
            
    </script>
</body>
</html>